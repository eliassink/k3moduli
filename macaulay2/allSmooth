--Check that the democratic-stable weak realization space is smooth, frame by frame.
--Each call to frameSmooth creates many new mutable objects. This script restarts 
--Macaulay2 for each new frame to avoid overflowing the mutable hash counter.

load "democratic";
L1 := {{1,2,4},{1,3,8},{1,7,9},{2,3,7},{2,5,9},{3,5,0},{4,5,6},{4,8,0},{6,7,8},{6,9,0}}; --configuration to use
allFrames = subsets(10,4);

if not instance(frameNumber,ZZ) then frameNumber = 0;
M2exec = commandLine#0 --executable name;
thisFile = commandLine#1 --the name of this file;

if frameNumber == #allFrames then true else (
  print("Frame "| toString(frameNumber) | "/" | toString(#allFrames) |":" | toString(allFrames#frameNumber)); 
  if frameSmooth(L1,allFrames#frameNumber) 
                    then exec(M2exec | "-E 'frameNumber = " | toString(frameNumber+1) | "' " | thisFile) else false
)
